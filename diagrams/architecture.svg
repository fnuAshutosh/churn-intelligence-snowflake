<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 620" width="1100" height="620" style="background:#0d1117;font-family:Inter,Segoe UI,sans-serif;">
  <defs>
    <!-- Glow filters -->
    <filter id="glow-blue">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="glow-purple">
      <feGaussianBlur stdDeviation="4" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>

    <!-- Animated gradient for arrows -->
    <linearGradient id="flow-grad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%"   stop-color="#29b6f6" stop-opacity="0"/>
      <stop offset="50%"  stop-color="#29b6f6" stop-opacity="1"/>
      <stop offset="100%" stop-color="#29b6f6" stop-opacity="0"/>
      <animateTransform attributeName="gradientTransform" type="translate" from="-1 0" to="1 0" dur="2s" repeatCount="indefinite"/>
    </linearGradient>

    <!-- Data packet marker -->
    <marker id="arrow" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#29b6f6"/>
    </marker>
    <marker id="arrow-purple" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#ce93d8"/>
    </marker>
    <marker id="arrow-green" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#66bb6a"/>
    </marker>
  </defs>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- TITLE -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <text x="550" y="38" text-anchor="middle" fill="#e0e0e0" font-size="20" font-weight="700" letter-spacing="1">
    BankCo Churn Intelligence â€” Event-Driven Data Flow
  </text>
  <text x="550" y="58" text-anchor="middle" fill="#546e7a" font-size="12">
    Snowflake Dynamic Tables Â· Cortex AI Â· Kafka Streaming
  </text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 1: DOCKER (Ingestion) -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="20" y="80" width="200" height="200" rx="12" fill="#0f2027" stroke="#1565c0" stroke-width="1.5"/>
  <text x="120" y="100" text-anchor="middle" fill="#42a5f5" font-size="11" font-weight="600">ğŸ³ DOCKER</text>

  <!-- Producer box -->
  <rect x="35" y="110" width="170" height="55" rx="8" fill="#1a237e" stroke="#42a5f5" stroke-width="1"/>
  <text x="120" y="130" text-anchor="middle" fill="#90caf9" font-size="12" font-weight="600">producer.py</text>
  <text x="120" y="148" text-anchor="middle" fill="#546e7a" font-size="10">TXN Â· LOG Â· USER events</text>
  <text x="120" y="160" text-anchor="middle" fill="#546e7a" font-size="10">200 events/min</text>

  <!-- Kafka box -->
  <rect x="35" y="178" width="170" height="55" rx="8" fill="#1a237e" stroke="#42a5f5" stroke-width="1"/>
  <text x="120" y="198" text-anchor="middle" fill="#90caf9" font-size="12" font-weight="600">Apache Kafka</text>
  <text x="120" y="215" text-anchor="middle" fill="#546e7a" font-size="10">bank_transactions topic</text>
  <text x="120" y="227" text-anchor="middle" fill="#546e7a" font-size="10">micro-batch consumer</text>

  <!-- Consumer box -->
  <rect x="35" y="246" width="170" height="25" rx="6" fill="#0d47a1" stroke="#42a5f5" stroke-width="0.8"/>
  <text x="120" y="263" text-anchor="middle" fill="#90caf9" font-size="11">consumer.py â†’ Snowflake</text>

  <!-- Arrow: producer â†’ kafka -->
  <line x1="120" y1="165" x2="120" y2="178" stroke="#42a5f5" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Animated packet: producer â†’ kafka -->
  <circle r="4" fill="#29b6f6" opacity="0.9">
    <animateMotion dur="1.2s" repeatCount="indefinite" path="M120,165 L120,178"/>
    <animate attributeName="opacity" values="0;1;0" dur="1.2s" repeatCount="indefinite"/>
  </circle>

  <!-- Arrow: kafka â†’ consumer -->
  <line x1="120" y1="233" x2="120" y2="246" stroke="#42a5f5" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 2: SNOWFLAKE RAW -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="260" y="80" width="220" height="200" rx="12" fill="#0f2027" stroke="#00838f" stroke-width="1.5"/>
  <text x="370" y="100" text-anchor="middle" fill="#26c6da" font-size="11" font-weight="600">â„ï¸ SNOWFLAKE â€” RAW LAYER</text>

  <!-- Tables -->
  <rect x="275" y="110" width="190" height="32" rx="6" fill="#004d40" stroke="#26c6da" stroke-width="0.8"/>
  <text x="370" y="131" text-anchor="middle" fill="#80cbc4" font-size="11">FACT_TRANSACTION_LEDGER</text>

  <rect x="275" y="150" width="190" height="32" rx="6" fill="#004d40" stroke="#26c6da" stroke-width="0.8"/>
  <text x="370" y="171" text-anchor="middle" fill="#80cbc4" font-size="11">APP_ACTIVITY_LOGS</text>

  <rect x="275" y="190" width="190" height="32" rx="6" fill="#004d40" stroke="#26c6da" stroke-width="0.8"/>
  <text x="370" y="211" text-anchor="middle" fill="#80cbc4" font-size="11">DIM_CUSTOMERS</text>

  <rect x="275" y="230" width="90" height="32" rx="6" fill="#004d40" stroke="#26c6da" stroke-width="0.8"/>
  <text x="320" y="251" text-anchor="middle" fill="#80cbc4" font-size="11">DIM_ACCOUNTS</text>

  <rect x="375" y="230" width="90" height="32" rx="6" fill="#004d40" stroke="#26c6da" stroke-width="0.8"/>
  <text x="420" y="251" text-anchor="middle" fill="#80cbc4" font-size="11">SUPPORT_CASES</text>

  <!-- Arrow: consumer â†’ raw (horizontal) -->
  <line x1="205" y1="258" x2="260" y2="200" stroke="#26c6da" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrow)"/>

  <!-- Animated packets: consumer â†’ raw tables -->
  <circle r="4" fill="#26c6da" opacity="0.9">
    <animateMotion dur="1.8s" repeatCount="indefinite" begin="0s" path="M205,258 L260,200"/>
    <animate attributeName="opacity" values="0;1;0" dur="1.8s" repeatCount="indefinite"/>
  </circle>
  <circle r="4" fill="#26c6da" opacity="0.9">
    <animateMotion dur="1.8s" repeatCount="indefinite" begin="0.6s" path="M205,258 L260,200"/>
    <animate attributeName="opacity" values="0;1;0" dur="1.8s" repeatCount="indefinite" begin="0.6s"/>
  </circle>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 3: DYNAMIC TABLES -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="520" y="80" width="220" height="200" rx="12" fill="#0f2027" stroke="#7b1fa2" stroke-width="1.5"/>
  <text x="630" y="100" text-anchor="middle" fill="#ce93d8" font-size="11" font-weight="600">ğŸ”„ DYNAMIC TABLES</text>
  <text x="630" y="115" text-anchor="middle" fill="#546e7a" font-size="9">Auto-refresh Â· No polling Â· Zero idle cost</text>

  <rect x="535" y="125" width="190" height="55" rx="8" fill="#4a148c" stroke="#ce93d8" stroke-width="1"/>
  <text x="630" y="145" text-anchor="middle" fill="#e1bee7" font-size="12" font-weight="600">DYN_CUSTOMER_FEATURES</text>
  <text x="630" y="161" text-anchor="middle" fill="#9575cd" font-size="10">30-day aggregates per customer</text>
  <text x="630" y="173" text-anchor="middle" fill="#9575cd" font-size="10">TARGET_LAG = 5 minutes</text>

  <rect x="535" y="195" width="190" height="70" rx="8" fill="#4a148c" stroke="#ce93d8" stroke-width="1"/>
  <text x="630" y="215" text-anchor="middle" fill="#e1bee7" font-size="12" font-weight="600">DYN_CHURN_PREDICTIONS</text>
  <text x="630" y="231" text-anchor="middle" fill="#9575cd" font-size="10">Heuristic churn score 0.0â€“1.0</text>
  <text x="630" y="245" text-anchor="middle" fill="#9575cd" font-size="10">HIGH / MEDIUM / LOW class</text>
  <text x="630" y="259" text-anchor="middle" fill="#9575cd" font-size="10">TARGET_LAG = 5 minutes</text>

  <!-- Arrow: raw â†’ dynamic (horizontal) -->
  <line x1="480" y1="165" x2="520" y2="155" stroke="#ce93d8" stroke-width="1.5" marker-end="url(#arrow-purple)"/>

  <!-- Animated packets: raw â†’ dynamic -->
  <circle r="4" fill="#ce93d8">
    <animateMotion dur="2.5s" repeatCount="indefinite" begin="0s" path="M480,165 L520,155"/>
    <animate attributeName="opacity" values="0;1;0" dur="2.5s" repeatCount="indefinite"/>
  </circle>
  <circle r="4" fill="#ce93d8">
    <animateMotion dur="2.5s" repeatCount="indefinite" begin="1.2s" path="M480,165 L520,155"/>
    <animate attributeName="opacity" values="0;1;0" dur="2.5s" repeatCount="indefinite" begin="1.2s"/>
  </circle>

  <!-- Arrow: features â†’ predictions (vertical inside box) -->
  <line x1="630" y1="180" x2="630" y2="195" stroke="#ce93d8" stroke-width="1.5" marker-end="url(#arrow-purple)"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 4: INTELLIGENCE (Stream + Task + LLM) -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="520" y="310" width="220" height="200" rx="12" fill="#0f2027" stroke="#c62828" stroke-width="1.5"/>
  <text x="630" y="330" text-anchor="middle" fill="#ef9a9a" font-size="11" font-weight="600">ğŸ§  INTELLIGENCE LAYER</text>

  <rect x="535" y="340" width="190" height="38" rx="6" fill="#7f0000" stroke="#ef9a9a" stroke-width="0.8"/>
  <text x="630" y="357" text-anchor="middle" fill="#ffcdd2" font-size="11" font-weight="600">STREAM_HIGH_RISK_CUSTOMERS</text>
  <text x="630" y="371" text-anchor="middle" fill="#e57373" font-size="9">CDC on DYN_CHURN_PREDICTIONS</text>

  <rect x="535" y="388" width="190" height="38" rx="6" fill="#7f0000" stroke="#ef9a9a" stroke-width="0.8"/>
  <text x="630" y="405" text-anchor="middle" fill="#ffcdd2" font-size="11" font-weight="600">TASK_GENERATE_EMAILS</text>
  <text x="630" y="419" text-anchor="middle" fill="#e57373" font-size="9">WHEN stream has data â†’ fires SP</text>

  <rect x="535" y="436" width="190" height="38" rx="6" fill="#7f0000" stroke="#ef9a9a" stroke-width="0.8"/>
  <text x="630" y="453" text-anchor="middle" fill="#ffcdd2" font-size="11" font-weight="600">CORTEX.COMPLETE (llama3-8b)</text>
  <text x="630" y="467" text-anchor="middle" fill="#e57373" font-size="9">7-day dedup Â· max 50/run</text>

  <rect x="535" y="484" width="190" height="20" rx="5" fill="#4e342e" stroke="#ef9a9a" stroke-width="0.8"/>
  <text x="630" y="498" text-anchor="middle" fill="#ffccbc" font-size="10">AGENT_INTERVENTION_LOG</text>

  <!-- Arrow: predictions â†’ stream (vertical) -->
  <line x1="630" y1="280" x2="630" y2="340" stroke="#ef9a9a" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrow)"/>
  <text x="645" y="315" fill="#546e7a" font-size="9">new HIGH rows</text>

  <!-- Animated packet: predictions â†’ stream -->
  <circle r="5" fill="#ef9a9a">
    <animateMotion dur="3s" repeatCount="indefinite" begin="0s" path="M630,280 L630,340"/>
    <animate attributeName="opacity" values="0;1;0" dur="3s" repeatCount="indefinite"/>
  </circle>

  <!-- Arrows inside intelligence layer -->
  <line x1="630" y1="378" x2="630" y2="388" stroke="#ef9a9a" stroke-width="1.2" marker-end="url(#arrow)"/>
  <line x1="630" y1="426" x2="630" y2="436" stroke="#ef9a9a" stroke-width="1.2" marker-end="url(#arrow)"/>
  <line x1="630" y1="474" x2="630" y2="484" stroke="#ef9a9a" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 5: SERVING -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="780" y="80" width="300" height="430" rx="12" fill="#0f2027" stroke="#2e7d32" stroke-width="1.5"/>
  <text x="930" y="100" text-anchor="middle" fill="#81c784" font-size="11" font-weight="600">ğŸ“Š SERVING LAYER</text>

  <!-- Cortex Search -->
  <rect x="795" y="115" width="270" height="60" rx="8" fill="#1b5e20" stroke="#66bb6a" stroke-width="1"/>
  <text x="930" y="135" text-anchor="middle" fill="#c8e6c9" font-size="12" font-weight="600">Cortex Search</text>
  <text x="930" y="151" text-anchor="middle" fill="#81c784" font-size="10">CHURN_LOGS_SEARCH</text>
  <text x="930" y="165" text-anchor="middle" fill="#546e7a" font-size="9">Natural language over APP_ACTIVITY_LOGS</text>

  <!-- Cortex Analyst -->
  <rect x="795" y="190" width="270" height="60" rx="8" fill="#1b5e20" stroke="#66bb6a" stroke-width="1"/>
  <text x="930" y="210" text-anchor="middle" fill="#c8e6c9" font-size="12" font-weight="600">Cortex Analyst</text>
  <text x="930" y="226" text-anchor="middle" fill="#81c784" font-size="10">semantic_model.yaml</text>
  <text x="930" y="240" text-anchor="middle" fill="#546e7a" font-size="9">"Show high risk customers by segment"</text>

  <!-- Streamlit in Snowflake -->
  <rect x="795" y="265" width="270" height="220" rx="8" fill="#1b5e20" stroke="#66bb6a" stroke-width="1"/>
  <text x="930" y="285" text-anchor="middle" fill="#c8e6c9" font-size="12" font-weight="600">Streamlit in Snowflake</text>
  <text x="930" y="300" text-anchor="middle" fill="#546e7a" font-size="9">Zero infrastructure Â· Native Snowpark session</text>

  <rect x="808" y="310" width="244" height="30" rx="5" fill="#2e7d32" stroke="#66bb6a" stroke-width="0.6"/>
  <text x="930" y="330" text-anchor="middle" fill="#e8f5e9" font-size="10">ğŸ“Š Overview â€” KPIs + Segment Chart</text>

  <rect x="808" y="348" width="244" height="30" rx="5" fill="#2e7d32" stroke="#66bb6a" stroke-width="0.6"/>
  <text x="930" y="368" text-anchor="middle" fill="#e8f5e9" font-size="10">ğŸ”´ High Risk Customer Table</text>

  <rect x="808" y="386" width="244" height="30" rx="5" fill="#2e7d32" stroke="#66bb6a" stroke-width="0.6"/>
  <text x="930" y="406" text-anchor="middle" fill="#e8f5e9" font-size="10">ğŸ“¡ Live Transaction + Error Feed</text>

  <rect x="808" y="424" width="244" height="30" rx="5" fill="#2e7d32" stroke="#66bb6a" stroke-width="0.6"/>
  <text x="930" y="444" text-anchor="middle" fill="#e8f5e9" font-size="10">âœ‰ï¸ AI Retention Email Viewer</text>

  <rect x="808" y="462" width="244" height="14" rx="4" fill="#388e3c" stroke="#66bb6a" stroke-width="0.5"/>
  <text x="930" y="473" text-anchor="middle" fill="#c8e6c9" font-size="9">ğŸ¤– Cortex Analyst Chat Interface</text>

  <!-- Arrows: dynamic â†’ serving -->
  <line x1="740" y1="145" x2="795" y2="145" stroke="#66bb6a" stroke-width="1.5" marker-end="url(#arrow-green)"/>
  <line x1="740" y1="220" x2="795" y2="220" stroke="#66bb6a" stroke-width="1.5" marker-end="url(#arrow-green)"/>

  <!-- Arrow: intervention log â†’ serving -->
  <line x1="725" y1="494" x2="795" y2="375" stroke="#66bb6a" stroke-width="1.2" stroke-dasharray="4,3" marker-end="url(#arrow-green)"/>

  <!-- Animated packets: dynamic â†’ serving -->
  <circle r="4" fill="#66bb6a">
    <animateMotion dur="2s" repeatCount="indefinite" begin="0s" path="M740,145 L795,145"/>
    <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite"/>
  </circle>
  <circle r="4" fill="#66bb6a">
    <animateMotion dur="2s" repeatCount="indefinite" begin="1s" path="M740,220 L795,220"/>
    <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite" begin="1s"/>
  </circle>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LEGEND -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="20" y="310" width="480" height="200" rx="10" fill="#0d1117" stroke="#263238" stroke-width="1"/>
  <text x="260" y="332" text-anchor="middle" fill="#78909c" font-size="11" font-weight="600">LEGEND &amp; KEY DESIGN DECISIONS</text>

  <circle cx="40" cy="355" r="5" fill="#29b6f6"/>
  <text x="52" y="359" fill="#90a4ae" font-size="10">Animated dots = live data packets in flight</text>

  <circle cx="40" cy="375" r="5" fill="#ce93d8"/>
  <text x="52" y="379" fill="#90a4ae" font-size="10">Dynamic Tables auto-refresh (no polling, no idle credits)</text>

  <circle cx="40" cy="395" r="5" fill="#ef9a9a"/>
  <text x="52" y="399" fill="#90a4ae" font-size="10">Stream fires Task ONLY when new HIGH-risk rows exist</text>

  <circle cx="40" cy="415" r="5" fill="#66bb6a"/>
  <text x="52" y="419" fill="#90a4ae" font-size="10">Streamlit in Snowflake â€” zero local infra, native Snowpark</text>

  <line x1="30" y1="435" x2="60" y2="435" stroke="#546e7a" stroke-width="1.5" stroke-dasharray="4,3"/>
  <text x="70" y="439" fill="#90a4ae" font-size="10">Dashed = event-driven trigger (not continuous)</text>

  <text x="260" y="460" text-anchor="middle" fill="#37474f" font-size="9">
    Warehouse: BANK_WAREHOUSE Â· Database: CHURN_DEMO Â· Schema: PUBLIC
  </text>
  <text x="260" y="475" text-anchor="middle" fill="#37474f" font-size="9">
    Kafka micro-batch: flush every 500 msgs OR 5s Â· LLM dedup: 7-day window
  </text>
  <text x="260" y="490" text-anchor="middle" fill="#37474f" font-size="9">
    Built for BankCo Technical Interview â€” Spring 2026
  </text>
</svg>
